trainer_type: XLAHLmTrainer

collator_type: seq2seq
dataset: fw-45b
stream_dataset: true

sequence_length: 256

bs: 4096
mini_bs: 32

warmup_steps: 2000
lr_steps: 20000
checkpoint_interval: 5000

start_lr: 0.00025
end_lr: 0.000025

optimizer_kwargs:
    beta1: 0.9
    weight_decay: 0.1
    scale_parameter: false
    relative_step: false

low_precision_optimizer: true

kl_w: 1.0
uncond_kl_w: 0.1
token_w: 50.0

kl_threshold: 10.0

clip_prob: 0.75

num_uncond: 4
