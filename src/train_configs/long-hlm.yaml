trainer_type: XLAHLmTrainer

collator_type: seq2seq
dataset: fw-45b
stream_dataset: true

sequence_length: 256

bs: 1024
mini_bs: 128

warmup_steps: 4000
lr_steps: 40000

checkpoint_interval: 5 # 5000
save_optimizer: true

start_lr: 0.0003
end_lr: 0.00003

optimizer_kwargs:
    betas: [0.9, 0.95]
    eps: 0.00000001
    weight_decay: 0.1
clip_grad_norm: 1.0

kl_w: 1.0
token_w: 50.0

kl_threshold: 10.0
clip_prob: 0.75

num_uncond: 8
